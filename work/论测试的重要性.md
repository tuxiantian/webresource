---
typora-root-url: ..
---

## 案例一

平台的使用人员发现这样一个问题

![微信图片_20190222161004](/images/work/论测试的重要性/微信图片_20190222161004.png)

![2019-02-22_164508](/images/work/论测试的重要性/2019-02-22_164508.png)

看着左图的代码，我是想不明白为啥交强险和商业险的位置会显示反了。直到我拿正式环境的数据放在本地调试才发现，当既有交强险又有商业险，循环处理的第一条数据是商业险时，就会出问题，会把商业险的数据放在前3个单元格。

如果测试的不仔细，看着维修结算单PDF文件已经导出来了。那么这个问题就只能由正式环境的使用人员来发现了。

而这种问题是写代码的时候不容易想到的，只有设计测试用例测试才能发现。要测试这段代码是否运转正常，设计的测试用例要覆盖4种情况，没有保险，有交强险，有商业险，既有交强险又有商业险。

过于自信是程序员的职业病，而反馈是其处方。千万不要想当然，自己动手测试是避免问题暴露给别人的最后机会。谁也不能保证一开始编码的时候，就是天衣无缝的。

## 案例二

![微信图片_20190223174726](/images/work/论测试的重要性/微信图片_20190223174726.png)

问题：一个运维人员出现了2条考核记录。

![2019-02-23_175736](/images/work/论测试的重要性/2019-02-23_175736.png)

GROUP BY u.`user_id`, p.`is_offline`导致出现了2条记录。低电量下线罚款和低电量待租罚款在查询列中都根据is_offline判断了，就不要再分组了。分组产生了2条数据。

数据结构如下

![TIM截图20190223180858](/images/work/论测试的重要性/TIM截图20190223180858.png)

## 案例三

![微信图片_20190225141435](/images/work/论测试的重要性/微信图片_20190225141435.jpg)

上图显示未调度的车辆数为0，但是却有罚款金额。直觉告诉我最可能的原因是有人修正了车辆数，而修正车辆数那一块可能有问题。

摘出其中的查询片段带入查询条件，分析查询结果发现修正车辆数与实际车辆数不一致，修正原因是“春节假期”。


```sql
SELECT u.`user_id`, u.`user_name` NAME, 
d.`advice_car_num`,d.`check_car_num`,u.check_coefficient,u.deduction,d.check_user,d.`check_reason` 
        FROM `t_check_dispatch_user` u
  LEFT JOIN `t_check_dispatch` d ON u.`stat_id`= d.`stat_id`
 WHERE d.`area_code`= '370724'
   AND d.`stat_date`>= '2019-02-05'
   AND d.`stat_date`<= '2019-02-10'
and u.`user_id` =1
 GROUP BY u.`user_id`;
```

![TIM截图20190225142854](/images/work/论测试的重要性/TIM截图20190225142854.png)

上图中的圈中的地方是有问题的。若修正车辆数和建议车辆数填的一样，算出来的checkRateDiff是0，若填的修正车辆数大于建议车辆数，算出来的checkRateDiff是负值，这时候是不会更新运维人员的罚款金额的。

正确的代码是下面这样的。

![TIM截图20190225144301](/images/work/论测试的重要性/TIM截图20190225144301.png)

实际上这段代码是复制生成运维人员罚款记录的方法，只有未达标的情况才会生成运维人员的罚款记录。但是它不适用这里的情况。

历史数据是这样修复的。查询出修正原因是“春节假期”的记录，调用updateCarCount方法再次处理一遍。

最后总结一下，我们要从下面几个方面提升测试水平。

- 测试的意识要有。

- 测试用例要设计。

- 测试的方法要总结。